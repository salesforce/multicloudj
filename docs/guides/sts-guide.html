<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <link rel="stylesheet" href="/multicloudj/assets/css/just-the-docs-default.css"> <link rel="stylesheet" href="/multicloudj/assets/css/just-the-docs-head-nav.css" id="jtd-head-nav-stylesheet"> <style id="jtd-nav-activation"> .site-nav > ul.nav-list:first-child > li > a, .site-nav > ul.nav-list:first-child > li > ul > li:not(:nth-child(1)) > a, .site-nav > ul.nav-list:first-child > li > ul > li > ul > li a { background-image: none; } .site-nav > ul.nav-list:not(:first-child) a, .site-nav li.external a { background-image: none; } .site-nav > ul.nav-list:first-child > li:nth-child(2) > ul > li:nth-child(1) > a { font-weight: 600; text-decoration: none; }.site-nav > ul.nav-list:first-child > li:nth-child(2) > button svg, .site-nav > ul.nav-list:first-child > li:nth-child(2) > ul > li:nth-child(1) > button svg { transform: rotate(-90deg); }.site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(2) > ul.nav-list, .site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(2) > ul.nav-list > li.nav-list-item:nth-child(1) > ul.nav-list { display: block; } </style> <script src="/multicloudj/assets/js/vendor/lunr.min.js"></script> <script src="/multicloudj/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>How to STS | MulticloudJ</title> <meta name="generator" content="Jekyll v4.4.1" /> <meta property="og:title" content="How to STS" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Substrate Agnostic Cloud SDK for Java" /> <meta property="og:description" content="Substrate Agnostic Cloud SDK for Java" /> <link rel="canonical" href="https://opensource.salesforce.com/multicloudj/guides/sts-guide.html" /> <meta property="og:url" content="https://opensource.salesforce.com/multicloudj/guides/sts-guide.html" /> <meta property="og:site_name" content="MulticloudJ" /> <meta property="og:type" content="website" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="How to STS" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"Substrate Agnostic Cloud SDK for Java","headline":"How to STS","url":"https://opensource.salesforce.com/multicloudj/guides/sts-guide.html"}</script> <!-- End Jekyll SEO tag --> </head> <body> <a class="skip-to-main" href="#main-content">Skip to main content</a> <svg xmlns="http://www.w3.org/2000/svg" class="d-none"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <!-- Feather. MIT License: https://github.com/feathericons/feather/blob/master/LICENSE --> <symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"> <title id="svg-external-link-title">(external link)</title> <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <!-- Bootstrap Icons. MIT License: https://github.com/twbs/icons/blob/main/LICENSE.md --> <symbol id="svg-copy" viewBox="0 0 16 16"> <title>Copy</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16"> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/> <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/> </svg> </symbol> <symbol id="svg-copied" viewBox="0 0 16 16"> <title>Copied</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16"> <path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header" role="banner"> <a href="/multicloudj/" class="site-title lh-tight"> MulticloudJ </a> <button id="menu-button" class="site-button btn-reset" aria-label="Toggle menu" aria-pressed="false"> <svg viewBox="0 0 24 24" class="icon" aria-hidden="true"><use xlink:href="#svg-menu"></use></svg> </button> </div> <nav aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="/multicloudj/" class="nav-list-link">MultiCloudJ Overview</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Usage Guides category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/multicloudj/guides/" class="nav-list-link">Usage Guides</a><ul class="nav-list"><li class="nav-list-item"><a href="/multicloudj/guides/sts-guide.html" class="nav-list-link">How to STS</a></li><li class="nav-list-item"><a href="/multicloudj/guides/blobstore-guide.html" class="nav-list-link">How to Blob store</a></li><li class="nav-list-item"><a href="/multicloudj/guides/docstore-guide.html" class="nav-list-link">How to Docstore</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Design category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/multicloudj/design/" class="nav-list-link">Design</a><ul class="nav-list"><li class="nav-list-item"><a href="/multicloudj/design/layers.html" class="nav-list-link">Layers</a></li><li class="nav-list-item"><a href="/multicloudj/design/flexibility.html" class="nav-list-link">Flexibility</a></li><li class="nav-list-item"><a href="/multicloudj/design/errors.html" class="nav-list-link">Exception Handling</a></li></ul></li><li class="nav-list-item"><a href="/multicloudj/api-java-doc.html" class="nav-list-link">Api Documentation</a></li></ul> </nav> <hr> <p style="text-align: center; font-size: 0.8rem; color: #aaa;"> This site if maintained by the MulticloudJ team. </p> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search" role="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search MulticloudJ" aria-label="Search MulticloudJ" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> </div> <div class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="/multicloudj/guides/">Usage Guides</a></li> <li class="breadcrumb-nav-list-item"><span>How to STS</span></li> </ol> </nav> <div id="main-content" class="main-content"> <main> <h1 id="sts-security-token-service"> <a href="#sts-security-token-service" class="anchor-heading" aria-labelledby="sts-security-token-service"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> STS (Security Token Service) </h1> <p>The <code class="language-plaintext highlighter-rouge">StsClient</code> class in the <code class="language-plaintext highlighter-rouge">multicloudj</code> library provides a portable interface for interacting with cloud provider security token services such as AWS STS, GCP IAM Credentials, or any other compatible implementation. It allows you to obtain temporary credentials, access tokens, and caller identity information in a cloud-neutral way.</p><hr /> <h2 id="overview"> <a href="#overview" class="anchor-heading" aria-labelledby="overview"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Overview </h2> <p>The <code class="language-plaintext highlighter-rouge">StsClient</code> is built on top of provider-specific implementations of <code class="language-plaintext highlighter-rouge">AbstractSts</code>. Each provider registers its implementation and is selected dynamically at runtime.</p><hr /> <h2 id="feature-support-across-providers"> <a href="#feature-support-across-providers" class="anchor-heading" aria-labelledby="feature-support-across-providers"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Feature Support Across Providers </h2> <h3 id="core-api-features"> <a href="#core-api-features" class="anchor-heading" aria-labelledby="core-api-features"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Core API Features </h3> <div class="table-wrapper"><table> <thead> <tr> <th>Feature Name</th> <th>GCP</th> <th>AWS</th> <th>ALI</th> <th>Comments</th> </tr> </thead> <tbody> <tr> <td><strong>Assume Role</strong></td> <td>✅ Supported</td> <td>✅ Supported</td> <td>✅ Supported</td> <td>Core feature for temporary credentials for role/service account</td> </tr> <tr> <td><strong>Get Caller Identity</strong></td> <td>✅ Supported</td> <td>✅ Supported</td> <td>✅ Supported</td> <td>Returns identity information of the current caller</td> </tr> <tr> <td><strong>Get Access Token</strong></td> <td>✅ Supported</td> <td>✅ Supported</td> <td>✅ Supported</td> <td>Get credentials using default env configs</td> </tr> </tbody> </table></div> <h3 id="configuration-options"> <a href="#configuration-options" class="anchor-heading" aria-labelledby="configuration-options"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Configuration Options </h3> <div class="table-wrapper"><table> <thead> <tr> <th>Configuration</th> <th>GCP</th> <th>AWS</th> <th>ALI</th> <th>Comments</th> </tr> </thead> <tbody> <tr> <td><strong>Region Support</strong></td> <td>✅ Supported</td> <td>✅ Supported</td> <td>✅ Supported</td> <td>All providers support region-specific operations</td> </tr> <tr> <td><strong>Endpoint Override</strong></td> <td>✅ Supported</td> <td>✅ Supported</td> <td>✅ Supported</td> <td>Custom endpoint configuration</td> </tr> </tbody> </table></div> <h3 id="provider-specific-notes"> <a href="#provider-specific-notes" class="anchor-heading" aria-labelledby="provider-specific-notes"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Provider-Specific Notes </h3> <p><strong>GCP (Google Cloud Platform)</strong></p> <ul> <li>Uses Google’s OAuth 2.0 access tokens for credentials and ID tokens for Caller Identity</li> </ul><hr /> <h2 id="creating-a-client"> <a href="#creating-a-client" class="anchor-heading" aria-labelledby="creating-a-client"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Creating a Client </h2> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">StsClient</span> <span class="n">stsClient</span> <span class="o">=</span> <span class="nc">StsClient</span><span class="o">.</span><span class="na">builder</span><span class="o">(</span><span class="s">"aws"</span><span class="o">)</span>
    <span class="o">.</span><span class="na">withRegion</span><span class="o">(</span><span class="s">"us-west-2"</span><span class="o">)</span>
    <span class="o">.</span><span class="na">build</span><span class="o">();</span>
</code></pre></div></div> <p>Optionally, you can set a custom endpoint:</p> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="no">URI</span> <span class="n">endpoint</span> <span class="o">=</span> <span class="no">URI</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="s">"https://sts.custom-endpoint.com"</span><span class="o">);</span>
<span class="nc">StsClient</span> <span class="n">stsClient</span> <span class="o">=</span> <span class="nc">StsClient</span><span class="o">.</span><span class="na">builder</span><span class="o">(</span><span class="s">"aws"</span><span class="o">)</span>
    <span class="o">.</span><span class="na">withRegion</span><span class="o">(</span><span class="s">"us-west-2"</span><span class="o">)</span>
    <span class="o">.</span><span class="na">withEndpoint</span><span class="o">(</span><span class="n">endpoint</span><span class="o">)</span>
    <span class="o">.</span><span class="na">build</span><span class="o">();</span>
</code></pre></div></div><hr /> <h2 id="getting-caller-identity"> <a href="#getting-caller-identity" class="anchor-heading" aria-labelledby="getting-caller-identity"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Getting Caller Identity </h2> <p>Retrieve the caller identity associated with the current credentials:</p> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">CallerIdentity</span> <span class="n">identity</span> <span class="o">=</span> <span class="n">stsClient</span><span class="o">.</span><span class="na">getCallerIdentity</span><span class="o">();</span>
<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Caller: "</span> <span class="o">+</span> <span class="n">identity</span><span class="o">.</span><span class="na">getArn</span><span class="o">());</span>
</code></pre></div></div><hr /> <h2 id="getting-an-access-token"> <a href="#getting-an-access-token" class="anchor-heading" aria-labelledby="getting-an-access-token"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Getting an Access Token </h2> <p>Use this when you need an OAuth2-style token (provider support may vary):</p> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">GetAccessTokenRequest</span> <span class="n">request</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">GetAccessTokenRequest</span><span class="o">();</span>
<span class="nc">StsCredentials</span> <span class="n">token</span> <span class="o">=</span> <span class="n">stsClient</span><span class="o">.</span><span class="na">getAccessToken</span><span class="o">(</span><span class="n">request</span><span class="o">);</span>
<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Access Token: "</span> <span class="o">+</span> <span class="n">token</span><span class="o">.</span><span class="na">getAccessToken</span><span class="o">());</span>
</code></pre></div></div><hr /> <h2 id="assuming-a-role"> <a href="#assuming-a-role" class="anchor-heading" aria-labelledby="assuming-a-role"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Assuming a Role </h2> <p>To assume a different identity (e.g., for cross-account access):</p> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">AssumedRoleRequest</span> <span class="n">request</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">AssumedRoleRequest</span><span class="o">();</span>
<span class="n">request</span><span class="o">.</span><span class="na">setRoleArn</span><span class="o">(</span><span class="s">"arn:aws:iam::123456789012:role/example-role"</span><span class="o">);</span>
<span class="n">request</span><span class="o">.</span><span class="na">setSessionName</span><span class="o">(</span><span class="s">"example-session"</span><span class="o">);</span>
<span class="nc">StsCredentials</span> <span class="n">credentials</span> <span class="o">=</span> <span class="n">stsClient</span><span class="o">.</span><span class="na">getAssumeRoleCredentials</span><span class="o">(</span><span class="n">request</span><span class="o">);</span>
<span class="nc">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">"Temporary Credentials: "</span> <span class="o">+</span> <span class="n">credentials</span><span class="o">.</span><span class="na">getAccessKeyId</span><span class="o">());</span>
</code></pre></div></div><hr /> <h2 id="error-handling"> <a href="#error-handling" class="anchor-heading" aria-labelledby="error-handling"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Error Handling </h2> <p>All errors are translated to <code class="language-plaintext highlighter-rouge">SubstrateSdkException</code> subclasses by the underlying driver. The client will automatically map exceptions to meaningful runtime errors based on the provider:</p> <div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">try</span> <span class="o">{</span>
    <span class="nc">CallerIdentity</span> <span class="n">identity</span> <span class="o">=</span> <span class="n">stsClient</span><span class="o">.</span><span class="na">getCallerIdentity</span><span class="o">();</span>
<span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="nc">SubstrateSdkException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
    <span class="c1">// Handle known errors: AccessDenied, Timeout, etc.</span>
    <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
<span class="o">}</span>
</code></pre></div></div> </main> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
